{% raw %}
{% assign all_pages = site.pages | sort: 'url' %}
{% assign root_paths = site.pages | map: 'url' | uniq %}

<ul class="tree">
    <li>Debug: root_paths = {{ root_paths | inspect }}</li>
    <li>Debug: all_pages = {{ all_pages | inspect }}</li>
  </ul>

<ul class="tree">
{% for path in root_paths %}
  {% include tree-node.html path=path pages=all_pages %}
{% endfor %}
</ul>
{% endraw %}